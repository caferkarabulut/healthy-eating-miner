# Render.com Deploy Configuration
# https://render.com/docs/yaml-spec

services:
  - type: web
    name: healthy-eating-api
    runtime: docker
    dockerfilePath: ./backend/Dockerfile
    dockerContext: ./backend
    autoDeploy: true
    envVars:
      # Database (Azure SQL / Cloud MSSQL)
      - key: DB_SERVER
        sync: false  # Set manually in Render dashboard
      - key: DB_NAME
        sync: false
      - key: DB_USER
        sync: false
      - key: DB_PASSWORD
        sync: false
      - key: DB_DRIVER
        value: "ODBC Driver 18 for SQL Server"
      - key: ENCRYPT
        value: "yes"
      - key: TRUST_SERVER_CERT
        value: "yes"
      
      # JWT
      - key: JWT_SECRET
        generateValue: true  # Auto-generate secure secret
      
      # OpenAI
      - key: OPENAI_API_KEY
        sync: false  # Set manually
      
      # Environment
      - key: ENV
        value: production
      - key: DEBUG
        value: "false"
      
      # CORS - Update with your Vercel domain after deploy
      - key: CORS_ORIGINS
        value: "https://healthy-eating.vercel.app,https://your-app.vercel.app"
      
      # Rate Limits
      - key: AI_RATE_LIMIT_PER_MINUTE
        value: "10"
      - key: AI_RATE_LIMIT_PER_HOUR
        value: "50"
    
    healthCheckPath: /health
    
    # Region (optional)
    # region: frankfurt
